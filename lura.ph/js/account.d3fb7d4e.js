(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["account"],{"1d97":function(e,a,n){"use strict";n("eacb")},5671:function(e,a,n){"use strict";n("717d")},"5c55":function(e,a,n){"use strict";n.r(a);var t=function(){var e=this,a=e.$createElement,n=e._self._c||a;return n("Dashboard",{attrs:{name:"Your Account",current:"Account"}},[n("div",{attrs:{id:"account-container"}},[n("CardAdd",{attrs:{modalOpen:e.cardAddOpen},on:{cardAdded:e.onCardAdded,modalClosed:function(a){e.cardAddOpen=!1}}}),n("div",{staticClass:"account-info"},[n("section",[n("h2",[e._v("Account Information")])]),n("section",{class:"info"===e.showSection?"expanded":""},[e.accountLoading?n("div",{staticClass:"loading"},[n("Loader")],1):e._e(),n("div",{staticClass:"header",on:{click:function(a){return e.expandSection("info")}}},[n("h3",[e._v("Information & Security")]),n("button",{on:{click:function(a){return e.expandSection("info")}}},[e._v(" "+e._s("info"===e.showSection?"-":"+")+" ")])]),n("div",{staticClass:"content"},[n("FormInput",{attrs:{name:"Full Name",value:e.user.name,type:"text",disabled:""}}),n("FormInput",{attrs:{name:"Email Address",value:e.user.email,type:"email",disabled:""}}),this.changePasswordOpen?n("div",{staticClass:"change-pwd"},[n("div",{staticClass:"divider"}),n("FormInput",{attrs:{name:"Old Password",error:e.oldPasswordError,type:"password"},model:{value:e.oldPassword,callback:function(a){e.oldPassword=a},expression:"oldPassword"}}),n("FormInput",{attrs:{name:"New Password",error:e.newPasswordError,type:"password"},model:{value:e.newPassword,callback:function(a){e.newPassword=a},expression:"newPassword"}}),n("FormInput",{attrs:{name:"Confirm New Password",type:"password"},model:{value:e.newPasswordConfirm,callback:function(a){e.newPasswordConfirm=a},expression:"newPasswordConfirm"}})],1):e._e(),n("button",{class:["right","padding",this.changePasswordOpen?"colored":""],on:{click:e.passwordChange}},[e._v(" "+e._s(this.changePasswordOpen?"Save New Password":"Change Password")+" ")])],1)]),n("section",{class:"api"===e.showSection?"expanded":""},[e.apiKeyLoading?n("div",{staticClass:"loading"},[n("Loader")],1):e._e(),n("div",{staticClass:"header",on:{click:function(a){return e.expandSection("api")}}},[n("h3",[e._v("API Details")]),n("button",{on:{click:function(a){return e.expandSection("api")}}},[e._v(" "+e._s("api"===e.showSection?"-":"+")+" ")])]),n("div",{staticClass:"content"},[n("router-link",{attrs:{to:"/dashboard/documents"}},[e._v(" Visit our API documentation ")]),n("FormInput",{attrs:{name:"API Token",value:e.user.apiKey||"Click 'Generate API Token' to get a new token",type:"text",disabled:""}}),n("button",{class:["right","padding"],on:{click:e.generateToken}},[e._v(" Generate API Token ")])],1)]),n("section",{class:["payment"===e.showSection?"expanded":"","payment"]},[n("div",{staticClass:"header",on:{click:function(a){return e.expandSection("payment")}}},[n("h3",[e._v("Payment Information")]),n("button",{on:{click:function(a){return e.expandSection("payment")}}},[e._v(" "+e._s("payment"===e.showSection?"-":"+")+" ")])]),e.purchaseLoading?n("div",{staticClass:"content card-loader"},[n("Loader",{attrs:{color:"#fff"}})],1):e._e(),e.purchaseLoading?e._e():n("div",{staticClass:"content"},[n("div",{staticClass:"row between"},[n("div",[n("h4",[e._v("Plan Information:")]),n("span",[e._v("Luraph "+e._s(e.user.plan.capitalize())+" (at $"+e._s(this.planCost)+" per "+e._s(e.planUsage)+")")])])]),"now"!==e.user.plan?n("div",{staticClass:"row between"},[n("div",[e.cancelAtNextDate?e._e():n("h4",[e._v("Next Subscription Billing Date:")]),e.cancelAtNextDate?n("h4",[e._v("Subscription Ends at Billing Date:")]):e._e(),n("span",[e._v(e._s(e.formattedPlanDate))])])]):e._e(),n("h4",{staticClass:"extra-padding"},[e._v("Select Card:")]),e.cardsLoading?n("div",{staticClass:"card-loader"},[n("Loader",{attrs:{color:"#fff",size:60}})],1):e._e(),n("div",{class:["cards",e.cardsLoading?"loading":""]},[n("CardList",{attrs:{selectedCard:this.selectedCard,shouldFetchCards:e.cardAddOpen,highlightCard:e.mainAccountCard,background:"var(--form-color)",selectColor:"var(--purple-primary)",gridView:""},on:{selectedCard:e.onCardSelect,loading:function(a){e.cardsLoading=!0},loadingFinished:e.cardsLoaded}}),e.hasCards?e._e():n("span",[e._v("There are no cards here!")]),n("div",{staticClass:"row less-margin"},[n("button",{on:{click:function(a){e.cardAddOpen=!0}}},[e._v(" Add Card ")]),e.hasCards?n("button",{on:{click:function(a){return e.onCardChange(e.selectedCard)}}},[e._v(" Change Card ")]):e._e(),"now"!==e.user.plan?n("button",{on:{click:e.onSubscriptionCancel}},[e._v(" Cancel Subscription ")]):e._e()])],1)])])])],1)])},r=[],o=(n("4fad"),n("5530")),s=(n("96cf"),n("1da1")),c=n("2f62"),d=n("4129"),i=n("555f"),u=n("a0a3"),l=n("a0de"),p=function(){var e=this,a=e.$createElement,n=e._self._c||a;return n("modal",{attrs:{modalOpen:e.modalOpen,loading:e.loading,hideSelf:!1},on:{modalClosed:this.modalClosed},scopedSlots:e._u([{key:"banner",fn:function(){return[n("h4",[e._v("Add New Card")])]},proxy:!0}])},[n("div",{attrs:{id:"purchase"}},[n("div",{staticClass:"form open"},[n("CardAdd",{on:{errorLoading:this.modalClosed,loading:function(a){e.loading=!0},loadingFinished:function(a){e.loading=!1},cardAdded:e.cardAdded}}),n("footer",[e._v(" By purchasing Luraph, you agree to Luraph's Terms and Conditions ")])],1)])])},h=[],w=n("7b94"),f={name:"Card-Add",components:{CardAdd:w["a"]},props:{modalOpen:Boolean},methods:{modalClosed:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!e&&this.loading||this.$emit("modalClosed")},cardAdded:function(e){var a=this;this.$emit("cardAdded",e),setTimeout((function(){a.loading=!1,a.modalClosed()}))},isOpen:function(e){return[e?"open":""]}},data:function(){return{loading:!1}}},g=f,m=(n("1d97"),n("2877")),C=Object(m["a"])(g,p,h,!1,null,"fe4be740",null),v=C.exports,b=n("a9dc"),x=n("6bf2"),k=n("b0b7"),P={name:"Account",components:{Loader:i["a"],Dashboard:d["a"],FormInput:u["a"],CardList:l["a"],CardAdd:v},methods:{expandSection:function(e){e===this.showSection&&(e=""),this.showSection=e},onCardSelect:function(e){console.log(e),this.selectedCard=e},onCardAdded:function(e){this.selectedCard=e,console.log("card added",e)},cardsLoaded:function(e){this.cardsLoading=!1,this.hasCards=e.length>0},onCardChange:function(e){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!a.cardsLoading&&!a.purchaseLoading&&a.hasCards&&""!==e&&e!==a.mainAccountCard){n.next=2;break}return n.abrupt("return");case 2:return a.purchaseLoading=!0,n.prev=3,n.next=6,k["a"].updateSubscriptionCardAsync(e);case 6:a.mainAccountCard=e,a.selectedCard=e,n.next=12;break;case 10:n.prev=10,n.t0=n["catch"](3);case 12:a.purchaseLoading=!1;case 13:case"end":return n.stop()}}),n,null,[[3,10]])})))()},onSubscriptionCancel:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if("now"!==e.user.plan&&!e.cardsLoading&&!e.purchaseLoading){a.next=2;break}return a.abrupt("return");case 2:return e.purchaseLoading=!0,a.prev=3,a.next=6,k["a"].cancelSubscriptionAsync();case 6:e.cancelAtNextDate=!0,a.next=12;break;case 9:a.prev=9,a.t0=a["catch"](3),alert("Error: ".concat(a.t0.errors.unknown));case 12:e.purchaseLoading=!1;case 13:case"end":return a.stop()}}),a,null,[[3,9]])})))()},fetchPlanInfo:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,t,r,o,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e.purchaseLoading){a.next=2;break}return a.abrupt("return");case 2:return e.purchaseLoading=!0,a.prev=3,a.next=6,k["a"].fetchSubscriptionAsync();case 6:n=a.sent.data,t=n.cost,r=n.paymentMethod,o=n.nextBillDate,s=n.cancelAtNextDate,e.planCost=t,e.mainAccountCard=r,e.selectedCard=r,e.nextBillDate=new Date(o),e.cancelAtNextDate=s,a.next=21;break;case 18:a.prev=18,a.t0=a["catch"](3),console.warn("Error",a.t0);case 21:e.purchaseLoading=!1;case 22:case"end":return a.stop()}}),a,null,[[3,18]])})))()},passwordChange:function(e){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a.changePasswordOpen){e.next=41;break}if(a.newPassword===a.newPasswordConfirm&&!a.accountLoading){e.next=3;break}return e.abrupt("return");case 3:return a.accountLoading=!0,a.oldPasswordError="",a.newPasswordError="",e.prev=6,e.next=9,x["a"].changePasswordAsync(a.oldPassword,a.newPassword);case 9:a.changePasswordOpen=!1,e.next=38;break;case 12:if(e.prev=12,e.t0=e["catch"](6),n=Object.entries(e.t0.errors),!n||!n.length){e.next=37;break}t=0;case 17:if(!(t<n.length)){e.next=37;break}if(r=n[t][1],r&&r.message){e.next=21;break}return e.abrupt("continue",34);case 21:if(!r.unknown){e.next=25;break}return alert("Error: ".concat(r.unknown)),a.accountLoading=!1,e.abrupt("return");case 25:console.log(r),e.t1=r.param,e.next="oldPassword"===e.t1?29:"newPassword"===e.t1?31:33;break;case 29:return a.oldPasswordError=r.message,e.abrupt("break",34);case 31:return a.newPasswordError=r.message,e.abrupt("break",34);case 33:return e.abrupt("break",34);case 34:t++,e.next=17;break;case 37:console.error("err",e.t0);case 38:a.accountLoading=!1,e.next=44;break;case 41:a.oldPasswordError="",a.newPaswordError="",a.changePasswordOpen=!0;case 44:case"end":return e.stop()}}),e,null,[[6,12]])})))()},generateToken:function(e){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a.apiKeyLoading=!0,e.prev=1,e.next=4,a.$store.dispatch("fetchGenApiKey");case 4:e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](1),alert("Error: ".concat(e.t0.message));case 9:a.apiKeyLoading=!1;case 10:case"end":return e.stop()}}),e,null,[[1,6]])})))()},scrollToAfterUpdate:function(e){}},computed:Object(o["a"])({formattedPlanDate:function(){return b["a"].getFormattedDate(this.nextBillDate)},planUsage:function(){return"now"!==this.user.plan?"month":"usage"}},Object(c["d"])(["user"])),mounted:function(){this.fetchPlanInfo()},data:function(){var e="",a=this.$route.params||{};return a.showBillingInfo&&(e="payment"),console.log(this.$route),{showSection:e,changePasswordOpen:!1,accountLoading:!1,apiKeyLoading:!1,purchaseLoading:!1,cardsLoading:!1,cardAddOpen:!1,hasCards:!1,planCost:0,nextBillDate:new Date,cancelAtNextDate:!1,oldPassword:"",newPassword:"",newPasswordError:"",oldPasswordError:"",newPasswordConfirm:"",mainAccountCard:"",selectedCard:""}}},_=P,A=(n("5671"),Object(m["a"])(_,t,r,!1,null,"741e3bcf",null));a["default"]=A.exports},"717d":function(e,a,n){},eacb:function(e,a,n){}}]);